<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hyundaimotors.hmb.cdppapp.mapper.TestMapper">
    
    <insert id="insertList" parameterType="TestDto" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
        INSERT INTO landing.PINK_FLOYD(
            album_name
            , release_date
            , special_char
            , what_num
        ) VALUES (
            #{albumName}
            , to_date(#{releaseDate},'YYYY-MM-DD')
            , #{specialChar}
            , #{whatNum}
        );
    </insert>

    <insert id="InsertInboundContactWorkflow" parameterType="s_contactDto" useGeneratedKeys="true" keyProperty="row_id" keyColumn="row_id">
        INSERT INTO landing.s_contact(
            integration_id
            , row_id
            , x_cpf
            , fst_name
            , last_name
            , birth_dt
            , sex_mf
            , home_ph_num
            , work_ph_num
            , cell_ph_num
            , email_addr
            , pref_comm_meth_cd
            , marital_stat_cd
            , suppress_call_flg
            , suppress_mail_flg
            , suppress_email_flg
            , x_printed_card
            , created_by
            , created
            , last_upd_by
            , last_upd
        ) VALUES (
            #{integration_id}
            , #{row_id}
            , #{x_cpf}
            , #{fst_name}
            , #{last_name}
            , #{birth_dt}
            , #{sex_mf}
            , #{home_ph_num}
            , #{work_ph_num}
            , #{cell_ph_num}
            , #{email_addr}
            , #{pref_comm_meth_cd}
            , #{marital_stat_cd}
            , #{suppress_call_flg}
            , #{suppress_mail_flg}
            , #{suppress_email_flg}
            , #{x_printed_card}
            , #{created_by}
            , to_date(#{created},'YYYY-MM-DD')
            , #{last_upd_by}
            , to_date(#{last_upd},'YYYY-MM-DD')
        );
    </insert>
        <insert id="InsertSContactXDto" parameterType="s_contact_xDto" useGeneratedKeys="true" keyProperty="row_id" keyColumn="row_id">
        INSERT INTO landing.s_contact_x(
            row_id
            , par_row_id
            , attrib_50
            , attrib_34
            , attrib_36
            , attrib_49
            , x_called_by
            , x_literacy
            , x_seg_behavioral
            , x_seg_value
            , x_seg_google
            , x_seg_facebook
            , x_seg_life_cycle
            , x_seg_interest
            , x_loyalty_optin_flg
            , created_by
            , created
            , last_upd_by
            , last_upd
        ) VALUES (
            #{row_id}
            , #{par_row_id}
            , #{attrib_50}
            , #{attrib_34}
            , #{attrib_36}
            , #{attrib_49}
            , #{x_called_by}
            , #{x_literacy}
            , #{x_seg_behavioral}
            , #{x_seg_value}
            , #{x_seg_google}
            , #{x_seg_facebook}
            , #{x_seg_life_cycle}
            , #{x_seg_interest}
            , #{x_loyalty_optin_flg}
            , 'admin_user'
            , now()
            , 'admin_user'
            , now()
        );
    </insert>

    <insert id="InsertSContactXMDtoList" parameterType="java.util.List">
        INSERT INTO landing.s_contact_xm(
            row_id
            , par_row_id
            , type
            , x_name
            , name
            , x_vehicle_year_model
            , x_vehicle_intent_change
            , x_is_current_flg
            , x_model
            , attrib_14
            , x_vehicle_cli_expec_val
            , created_by
            , created
            , last_upd_by
            , last_upd
        ) VALUES 
        <foreach collection="list" item="item" separator=",">
        (
            #{item.row_id}
            , #{item.par_row_id}
            , 'N'
            , #{item.x_name}
            , #{item.x_name}
            , #{item.x_vehicle_year_model}
            , #{item.x_vehicle_intent_change}
            , #{item.x_is_current_flg}
            , #{item.x_model}
            , #{item.attrib_14}
            , #{item.x_vehicle_cli_expec_val}
            , 'admin_user'
            , now()
            , 'admin_user'
            , now()
        )
        </foreach>
    </insert>

    <select id="getList" parameterType="TestDto" resultType="TestDto">
        SELECT 
            id
            , album_name as albumName
            , release_date as releaseDate
            , special_char as specialChar
            , what_num as whatNum
        FROM 
            landing.PINK_FLOYD
        WHERE
            id = CAST(#{id} AS UUID)    
    </select>

    <insert id="getAccountList" parameterType="AccountDto">
        INSERT INTO landing.hmb_contact(
            integrationid
            , cpf
            , firstname
            , lastname
            , birthdate
            , gender
            , source
            , homephone
            , workphone
            , cellphone
            , emailaddress
            , wayofcontact
            , occupation
            , maritalstatus
            , income
            , carofinterest
            , calledby
            , literacy
            , behavioralsegment
            , valuesegment
            , googlesegment
            , facebooksegment
            , lifecyclesegment
            , interestsegment
            , contactoptin
            , streetaddress
            , streetaddress2
            , streetaddress3
            , county
            , city
            , state
            , postalcode
            , suppressallcalls
            , suppressallmailings
            , suppressallemails
            , suppressallsms
            , printedcard
            , already_customer
        ) VALUES (
            #{integrationId}
            , #{cpf}
            , #{firstName}
            , #{lastName}
            , #{birthDate}
            , #{gender}
            , #{source}
            , #{homePhone}
            , #{workPhone}
            , #{cellPhone}
            , #{emailAddress}
            , #{wayOfContact}
            , #{occupation}
            , #{maritalStatus}
            , #{income}
            , #{carOfInterest}
            , #{calledBy}
            , #{literacy}
            , #{behavioralSegment}
            , #{valueSegment}
            , #{googleSegment}
            , #{facebookSegment}
            , #{lifeCycleSegment}
            , #{interestSegment}
            , #{contactOptIn}
            , #{streetAddress}
            , #{streetAddress2}
            , #{streetAddress3}
            , #{county}
            , #{city}
            , #{state}
            , #{postalCode}
            , #{suppressAllCalls}
            , #{suppressAllMailings}
            , #{suppressAllEmails}
            , #{suppressAllSMS}
            , #{printedCard}
            , #{already_customer}
        );
    </insert>

    <insert id="getCarList" parameterType="java.util.List">
        INSERT INTO landing.car(
            name
            , yearmodel
            , intentiontochange
            , iscurrent
            , carmodel
            , mileage
            , clientexpectedvalue
        ) VALUES 
        <foreach collection="list" item="item" separator=",">
            (
                #{item.name}
                , #{item.yearModel}
                , #{item.intentionToChange}
                , #{item.isCurrent}
                , #{item.carModel}
                , #{item.mileage}
                , #{item.clientExpectedValue}
            )
        </foreach>    
    </insert>

    <insert id="getAppsList" parameterType="java.util.List">
        INSERT INTO landing.app(
            name
            , startdate
            , status
        ) VALUES 
        <foreach collection="list" item="item" separator=",">
            (
                #{item.name}
                , #{item.startDate}
                , #{item.status}
            )
        </foreach>    
    </insert>
</mapper>
