<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hyundaimotors.hmb.cdppapp.mapper.AccountReverseMapper">
    <select id="getAccount" parameterType="AccountReverseDto" resultType="string">
        select 
            row_id as rowId
        from
            process.account a
        where
            row_id = #{externalId}
    </select>

    <update id="updateSflId" parameterType="AccountReverseDto">
        update process.account set
            sfid = #{sfId}
        where
            row_id = #{externalId}
    </update>

    <insert id="insertAccount" parameterType="AccountReverseDto" useGeneratedKeys="true" keyProperty="rowId" keyColumn="row_id">
        insert into process.account
		(
			billingstreet
            , billingstreet_2__c
            , billingstreet_3__c
            , neighborhood
            , billingcountry
            , billingcity
            , billingstate
            , billingpostalcode
            , billinglatitude
            , billinglongitude
            , "type"
            , firstname
            , lastname
            , personemail
            , personhomephone
            , companyphone__pc
            , workphone__c
            , personmobilephone
            , gender__pc
            , pcd__c
            , income__c
            , productofinterest__c
            , literacy__c
            , calledby__c
            , employee__c
            , favoritedealer__c
            , dealercode__c
            , crmindex__c
            , engagement__c
            , optinflag__c
            , satificationlevel__c
            , loyaltyexpirationdate__c
            , loyaltyactivationdate__c
            , loyaltystatus__c
            , cpf__c
            , receiveproductnewsflag__c
            , receiveretailoffersflag__c
            , receiveserviceoffersflag__c
            , receivenewsletterflag__c
            , receiveeventsflag__c
            , receiveresearchflag__c
            , blockedmobile__c
            , x_printed_card__c
            , blockedvideocall__c
            , preferredcontactchannel__c
            , calloptyn__pc
            , directmailoptyn__pc
            , blockedletters__c
            , emailoptyn__pc
            , blockedemails__pc
            , blockedsms__c
            , blockedwhatsapp__c
            , loyaltyengagementindex__c
            , loyaltylifecycle__c
            , salutation
            , personbirthdate
            , influentialperson__c
            , registrysource__c
            , loyaltyvalue__c
            , occupation__pc
            , corporateregistrationnumber__c
            , "name"
            , corporaterepresentativename__c
            , ori_cd__c
            , x_contracted_since__c
            , phone
            , fax
            , emailaddress__c
            , website
            , situationstatusreason__c
            , region__c
            , businesstype__c
            , industry
            , x_tot_flt_size__c
            , fleettype__c
            , dealershoptype__c
            , salesflag__c
            , serviceflag__c
            , businesshours__c
            , facebook__c
            , x_sales_rep__c
            , description
            , leadmanager__c
            , dms__c
            , apikey__c
            , whatsappphone__c
            , cust_stat_cd__c
            , partnertype__c
            , numberofemployees
            , prtnrshp_start_dt__c
            , prtnrshp_end_dt__c
            , customersap__c
            , legacy_created
            , integrationid
            , recordtypeid
            , sfid
            , process_account_type
		)values(
            COALESCE(#{personMailingStreet}, #{billingStreet}) 
            , #{houseBuildingNo}
            , #{complement}
            , #{neighborhood}
            , #{billingCountry}
            , COALESCE(#{personMailingCity}, #{billingCity})
            , COALESCE(#{personMailingState}, #{billingState})
            , COALESCE(#{personMailingPostalCode}, #{billingPostalCode})
            , COALESCE(#{personMailingLatitude}::float8, #{billingLatitude}::float8)
            , COALESCE(#{personMailingLongitude}::float8, #{billingLongitude}::float8)
            , #{type}
            , #{firstName}
            , #{lastName}
            , #{personEmail}
            , #{personHomePhone}
            , #{workPhone}
            , #{workPhone}
            , #{personMobilePhone}
            , #{genderPC}
            , #{pcd}
            , #{income}
            , #{productOfInterest}
            , #{literacy}
            , #{calledBy}
            , case when #{employee} = 'Y' then true else false end
            , #{dealerCode}
            , #{dealerCode}
            , #{crmIndex}
            , #{engagementIndex}
            , case when #{optInFlag} = 'Y' then true else false end
            , #{satisficationLevel}
            , #{cnhexpirationDate}::timestamp
            , #{loyaltyActivationDate}::timestamp
            , #{loyaltyStatus}
            , #{cpf}
            , case when #{receiveProductNewsFlag} = 'Y' then true else false end
            , case when #{receiveRetailOffersFlag} = 'Y' then true else false end
            , case when #{receiveServiceOffersFlag} = 'Y' then true else false end
            , case when #{receiveNewsLetterFlag} = 'Y' then true else false end
            , case when #{receiveEventsFlag} = 'Y' then true else false end
            , case when #{receiveResearchFlag} = 'Y' then true else false end
            , case when #{blockedMobile} = 'Y' then true else false end
            , case when #{blockedVideoCall} = 'Y' then true else false end
            , case when #{blockedVideoCall} = 'Y' then true else false end
            , #{preferredContactChannel}
            , case when #{blockedCalls} = 'Y' then true else false end
            , case when #{blockedletters} = 'Y' then true else false end
            , case when #{blockedletters} = 'Y' then true else false end
            , case when #{blockedEmails} = 'Y' then true else false end
            , case when #{blockedEmails} = 'Y' then true else false end
            , case when #{blockedSms} = 'Y' then true else false end
            , case when #{blockedWhatsapp} = 'Y' then true else false end
            , #{engagementIndex}
            , #{lifeCycle}
            , #{salutation}
            , #{personBirthdate}::date
            , #{influentialPerson}
            , #{registrySource}
            , #{loyaltyValue}
            , #{occupation}
            , #{cnpj}
            , #{name}
            , #{nickname}
            , #{accountCategory}
            , #{contractRenewalDate}
            , #{phone}
            , #{fax}
            , #{emailAddress}
            , #{website}
            , #{situationStatusReason}
            , #{region}
            , #{businessType}
            , #{industry}
            , #{fleetSize}
            , #{organizationType}
            , #{dealershopType}
            , case when #{salesFlag} = 'Y' then true else false end
            , case when #{serviceFlag} = 'Y' then true else false end
            , #{businessHours}
            , #{facebook}
            , #{fleetAdministrator}
            , #{description}
            , #{leadManager}
            , #{dms}
            , #{apikey}
            , #{whatsappPhone}
            , #{situationStatus}
            , #{partnerType}
            , #{numberOfEmployees}
            , #{operationDate}::date
            , #{terminationDate}::date
            , #{customerSap}
            , #{legacyCreatedDate}::timestamp
            , #{integratedId}
            , #{recordTypeId}
            , #{sfId}
            , #{processAccountType}
        )
    </insert>

    <insert id="insertDpContact" parameterType="AccountReverseDto">
        insert into process."S_CONTACT"
        (
            row_id
            , con_cd
            , fst_name
            , last_name
            , email_addr
            , home_ph_num
            , work_ph_num
            , cell_ph_num
            , sex_mf
            , x_pne_flg
            , x_cpf
            , X_OPTIN_PRODUCT_FLG
            , X_OPTIN_RETAIL_FLG
            , X_OPTIN_OFFER_FLG
            , X_OPTIN_NEWS_FLG
            , X_OPTIN_EVENTS_FLG
            , X_OPTIN_RESEARCH_FLG
            , X_OPTIN_PHONE
            , X_SUP_GONE_AWAY
            , PREF_COMM_METH_CD
            , MARITAL_STAT_CD
            , SUPPRESS_CALL_FLG
            , SUPPRESS_MAIL_FLG
            , SUPPRESS_EMAIL_FLG
            , X_PRINTED_CARD
            , PER_TITLE
            , BIRTH_DT
            , created
            , created_by
            , last_upd
            , last_upd_by
        )
        values(
            #{rowId}
            , #{type}
            , #{firstName}
            , #{lastName}
            , #{personEmail}
            , #{personHomePhone}
            , #{workPhone}
            , #{personMobilePhone}
            , #{genderPC}
            , #{pcd}
            , #{cpf}
            , #{receiveProductNewsFlag}
            , #{receiveRetailOffersFlag}
            , #{receiveServiceOffersFlag}
            , #{receiveNewsLetterFlag}
            , #{receiveEventsFlag}
            , #{receiveResearchFlag}
            , #{blockedMobile}
            , #{blockedVideoCall}
            , #{preferredContactChannel}
            , #{maritalStatus}
            , #{blockedCalls}
            , #{blockedletters}
            , #{blockedEmails}
            , #{blockedWhatsapp}
            , #{salutation}
            , #{personBirthdate}::timestamp
            , #{legacyCreatedDate}::timestamp
            , 'SFDC'
            , #{legacyCreatedDate}::timestamp
            , 'SFDC' 
        )
    </insert>

    <insert id="insertDpContactSub" parameterType="AccountReverseDto">
        insert into process."S_CONTACT_X"
        (
            row_id
            , par_row_id
            , ATTRIB_36
            , ATTRIB_49
            , X_LITERACY
            , X_CALLED_BY
            , X_EMPLOYEE_FLG
            , X_FAVORITE_DEALER
            , x_loyalty_crm_index
            , x_loyalty_engagement
            , x_loyalty_optin_flg
            , x_loyalty_satisfaction
            , X_CNH_EXP_DATE
            , X_LOYALTY_ACT_DT
            , X_LOYALTY_STATUS
            , X_SEG_LIFE_CYCLE
            , attrib_50
            , ATTRIB_45
            , X_SEG_VALUE
            , ATTRIB_34
            , created
            , created_by
            , last_upd
            , last_upd_by
        )values(
            #{rowId}
            , #{rowId}
            , #{income}
            , #{productOfInterest}
            , #{literacy}
            , #{calledBy}
            , #{employee}
            , #{dealerCode}
            , #{crmIndex}
            , #{engagementIndex}
            , #{optInFlag}
            , #{satisficationLevel}
            , #{cnhexpirationDate}::timestamp
            , #{loyaltyActivationDate}::timestamp
            , #{loyaltyStatus}
            , #{lifeCycle}
            , #{influentialPerson}
            , #{registrySource}
            , #{loyaltyValue}
            , #{occupation}
            , #{legacyCreatedDate}::timestamp
            , 'SFDC'
            , #{legacyCreatedDate}::timestamp
            , 'SFDC'
        )
    </insert>

    <insert id="insertDpOrgExt" parameterType="AccountReverseDto">
        insert into process."S_ORG_EXT"
			(
				row_id
				, x_cnpj
				, Name
				, X_NICKNAME
				, ORI_CD
				, X_CONTRACTED_SINCE
				, SOURCE_CD
				, MAIN_PH_NUM
				, MAIN_FAX_PH_NUM
				, MAIN_EMAIL_ADDR
				, URL
				, X_REASON_STATUS
				, OU_NUM
				, REGION
				, ACCNT_TYPE_CD
				, PRTNRSHP_START_DT
				, X_WHATSAPP_PH_NUM
				, CUST_STAT_CD
				, X_SALES_REP
				, DESC_TEXT
				, created
				, created_by
				, last_upd
				, last_upd_by
			)values(
                #{rowId}
                , #{cnpj}
                , #{name}
                , #{nickname}
                , #{accountCategory}
                , #{contractRenewalDate}::timestamp
                , #{registrySource}
                , #{phone}
                , #{fax}
                , #{emailAddress}
                , #{website}
                , #{situationStatusReason}
                , #{dealerCode}
                , #{region}
                , #{type}
                , #{operationDate}::timestamp
                , #{whatsappPhone}
                , #{situationStatus}
                , #{fleetAdministrator}
                , #{description}
                , #{legacyCreatedDate}::timestamp
                , 'SFDC'
                , #{legacyCreatedDate}::timestamp
                , 'SFDC'
            )
    </insert>

    <insert id="insertReplicaAcc" parameterType="AccountReverseDto">
        insert into "replica".account
        (
            billingstreet
            , housebuildingno__c
            , complement__c
            , neighborhood__c
            , billingcountry
            , billingcity
            , billingstate
            , billingpostalcode
            , billinglatitude
            , billinglongitude
            , type
            , firstname
            , lastname
            , personemail
            , personhomephone
            , workphone__c
            , personmobilephone
            , gender__pc
            , pcd__c
            , income__c
            , productofinterest__c
            , literacy__c
            , calledby__c
            , employee__c
            , dealercode__c
            , dealercode__c
            , crmindex__c
            , engagementindex__c
            , optinflag__c
            , satisficationlevel__c
            , loyaltyexpirationdate__c
            , loyaltyactivationdate__c
            , loyaltystatus__c
            , cpf__c
            , receiveproductnewsflag__c
            , receiveretailoffersflag__c
            , receiveserviceoffersflag__c
            , receivenewsletterflag__c
            , receiveeventsflag__c
            , receiveresearchflag__c
            , blockedmobile__c
            , blockedvideocall__c
            , blockedvideocall__c
            , preferredcontactchannel__c
            , blockedcalls__c
            , blockedletters__c
            , blockedemails__c
            , blockedsms__c
            , blockedwhatsapp__c
            , engagementindex__c
            , lifecycle__c
            , salutation
            , personbirthdate
            , influentialperson__c
            , registrysource__c
            , loyaltyvalue__c
            , occupation__pc
            , cnpj__c
            , name
            , nickname__c
            , accountcategory__c
            , contractrenewaldate__c
            , phone
            , fax
            , emailaddress__c
            , website
            , situationstatusreason__c
            , region__c
            , businesstype__c
            , industry
            , fleetsize__c
            , organizationtype__c
            , dealershoptype__c
            , salesflag__c
            , serviceflag__c
            , businesshours__c
            , facebook__c
            , fleetadministrator__c
            , description
            , leadmanager__c
            , dms__c
            , apikey__c
            , whatsappphone__c
            , situationstatus__c
            , partnertype__c
            , numberofemployees
            , operationdate__c
            , terminationdate__c
            , customersap__c
            , legacycreateddate__c
            , integratedid__c
            , recordtypeid
            , sfid
            , external_id__c
        )values(
            #{billingStreet}
            , #{houseBuildingNo}
            , #{complement}
            , #{neighborhood}
            , #{billingCountry}
            , #{billingCity}
            , #{billingState}
            , #{billingPostalCode}
            , #{billingLatitude}::float8
            , #{billingLongitude}::float8
            , #{type}
            , #{firstName}
            , #{lastName}
            , #{personEmail}
            , #{personHomePhone}
            , #{workPhone}
            , #{personMobilePhone}
            , #{genderPC}
            , #{pcd}
            , #{income}
            , #{productOfInterest}
            , #{literacy}
            , #{calledBy}
            , case when #{employee} = 'Y' then true else false end
            , #{dealerCode}
            , #{dealerCode}
            , #{crmIndex}
            , #{engagementIndex}
            , case when #{optInFlag} = 'Y' then true else false end
            , #{satisficationLevel}
            , #{cnhexpirationDate}::timestamp
            , #{loyaltyActivationDate}::timestamp
            , #{loyaltyStatus}
            , #{cpf}
            , case when #{receiveProductNewsFlag} = 'Y' then true else false end
            , case when #{receiveRetailOffersFlag} = 'Y' then true else false end
            , case when #{receiveServiceOffersFlag} = 'Y' then true else false end
            , case when #{receiveNewsLetterFlag} = 'Y' then true else false end
            , case when #{receiveEventsFlag} = 'Y' then true else false end
            , case when #{receiveResearchFlag} = 'Y' then true else false end
            , case when #{blockedMobile} = 'Y' then true else false end
            , case when #{blockedVideoCall} = 'Y' then true else false end
            , case when #{blockedVideoCall} = 'Y' then true else false end
            , #{preferredContactChannel}
            , case when #{blockedCalls} = 'Y' then true else false end
            , case when #{blockedletters} = 'Y' then true else false end
            , case when #{blockedEmails} = 'Y' then true else false end
            , case when #{blockedSms} = 'Y' then true else false end
            , case when #{blockedWhatsapp} = 'Y' then true else false end
            , #{engagementIndex}
            , #{lifeCycle}
            , #{salutation}
            , #{personBirthdate}::date
            , #{influentialPerson}
            , #{registrySource}
            , #{loyaltyValue}
            , #{occupation}
            , #{cnpj}
            , #{name}
            , #{nickname}
            , #{accountCategory}
            , #{contractRenewalDate}
            , #{phone}
            , #{fax}
            , #{emailAddress}
            , #{website}
            , #{situationStatusReason}
            , #{region}
            , #{businessType}
            , #{industry}
            , #{fleetSize}
            , #{organizationType}
            , #{dealershopType}
            , case when #{salesFlag} = 'Y' then true else false end
            , case when #{serviceFlag} = 'Y' then true else false end
            , #{businessHours}
            , #{facebook}
            , #{fleetAdministrator}
            , #{description}
            , #{leadManager}
            , #{dms}
            , #{apikey}
            , #{whatsappPhone}
            , #{situationStatus}
            , #{partnerType}
            , #{numberOfEmployees}
            , #{operationDate}::date
            , #{terminationDate}::date
            , #{customerSap}
            , #{legacyCreatedDate}::timestamp
            , #{integratedId}
            , #{recordTypeId}
            , #{sfId}
            , #{rowId}
        )
    </insert>
</mapper>
